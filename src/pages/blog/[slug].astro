---
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";
import SiteLayout from "../../layouts/SiteLayout.astro";
import Navbar from "../../components/Navbar.astro";
import Footer from "../../components/Footer.astro";

export async function getStaticPaths() {
    const blogEntries = await getCollection("blog");
    return blogEntries.map((entry) => ({
        params: { slug: entry.slug },
        props: { entry },
    }));
}

interface Props {
    entry: CollectionEntry<"blog">;
}

const { entry } = Astro.props;
const { Content } = await entry.render();

const base = import.meta.env.BASE_URL;
---

<SiteLayout title={`${entry.data.title} | Astroria Blog`}>
    <Navbar />

    <main class="pt-32 pb-20">
        <article class="container-custom max-w-3xl mx-auto">
            <!-- Header -->
            <header class="mb-10 text-left space-y-6">
                <div class="flex items-center flex-wrap gap-3 text-sm text-gray-500">
                    <span
                        class="px-4 py-2 text-xs font-bold uppercase tracking-[0.2em] bg-cyan-500/20 text-cyan-300 rounded-full border border-cyan-500/30"
                    >
                        {entry.data.category}
                    </span>
                    <span class="font-semibold text-gray-300">{entry.data.author}</span>
                    <span>•</span>
                    <time>
                        {
                            entry.data.pubDate.toLocaleDateString("en-US", {
                                year: "numeric",
                                month: "long",
                                day: "numeric",
                            })
                        }
                    </time>
                </div>

                <h1
                    class="text-4xl md:text-5xl font-bold leading-tight tracking-tight"
                >
                    {entry.data.title}
                </h1>

                <p class="text-lg text-gray-300 leading-relaxed">
                    {entry.data.description}
                </p>
            </header>

            <!-- Hero Image Placeholder -->
            <div
                class="mb-12 h-80 bg-gradient-to-br from-cyan-500/10 to-blue-500/10 rounded-2xl border border-white/10 relative overflow-hidden"
            >
                <div
                    class="absolute inset-0 bg-gradient-to-t from-dark-950 via-transparent to-transparent"
                >
                </div>
            </div>

            <!-- Content -->
            <div class="prose prose-invert prose-lg max-w-none leading-relaxed">
                <Content />
            </div>

            <!-- CTA -->
            <div
                class="mt-16 p-8 bg-gradient-to-br from-cyan-500/10 to-blue-500/10 border border-cyan-500/20 rounded-2xl text-center"
            >
                <h3 class="text-2xl font-bold text-white mb-4">
                    Ready to Transform Your Operations?
                </h3>
                <p class="text-gray-400 mb-6">
                    Let's discuss how Bitrix24 can solve your specific
                    challenges.
                </p>
                <a
                    href={`${base}#contact`}
                    class="inline-block px-8 py-4 bg-cyan-500 text-black font-bold rounded-full hover:bg-cyan-400 transition-all duration-300"
                >
                    Schedule Consultation
                </a>
            </div>

            <!-- Back to Blog -->
            <div class="mt-12 text-center">
                <a
                    href={`${base}blog`}
                    class="text-cyan-400 hover:text-cyan-300 transition-colors font-semibold"
                >
                    ← Back to All Articles
                </a>
            </div>
        </article>
    </main>

    <Footer />
</SiteLayout>

<style is:global>
    .prose {
        color: #e5e5e5;
    }

    .prose h2 {
        color: white;
        font-size: 2rem;
        font-weight: 700;
        margin-top: 2.5rem;
        margin-bottom: 1rem;
        font-family: var(--font-heading);
    }

    .prose h3 {
        color: white;
        font-size: 1.5rem;
        font-weight: 600;
        margin-top: 2rem;
        margin-bottom: 0.75rem;
        font-family: var(--font-heading);
    }

    .prose p {
        margin-bottom: 1.5rem;
        line-height: 1.8;
    }

    .prose ul,
    .prose ol {
        margin-left: 1.5rem;
        margin-bottom: 1.5rem;
        padding-left: 1.5rem;
    }

    .prose li {
        margin-bottom: 0.5rem;
        color: #d1d5db;
    }

    .prose ul li {
        list-style: disc;
    }

    .prose ol li {
        list-style: decimal;
    }

    .prose li::marker {
        color: var(--color-primary-400);
    }

    .prose strong {
        color: white;
        font-weight: 600;
    }

    .prose blockquote {
        border-left: 4px solid var(--color-primary-400);
        padding-left: 1.5rem;
        margin: 2rem 0;
        font-style: italic;
        color: #d1d5db;
    }

    .prose a {
        color: var(--color-primary-400);
        text-decoration: underline;
        transition: color 0.2s;
    }

    .prose a:hover {
        color: var(--color-primary-500);
    }

    .prose code {
        background: rgba(255, 255, 255, 0.05);
        padding: 0.2rem 0.4rem;
        border-radius: 0.25rem;
        font-size: 0.9em;
        color: var(--color-primary-400);
    }

    .prose pre {
        background: rgba(255, 255, 255, 0.04);
        padding: 1rem 1.25rem;
        border-radius: 0.75rem;
        border: 1px solid rgba(255, 255, 255, 0.08);
        overflow-x: auto;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
    }

    .prose table {
        width: 100%;
        border-collapse: collapse;
        margin: 2rem 0;
        font-size: 0.95rem;
    }

    .prose th,
    .prose td {
        border: 1px solid rgba(255, 255, 255, 0.1);
        padding: 0.85rem 1rem;
    }

    .prose th {
        background: rgba(34, 211, 238, 0.08);
        color: #f8fafc;
        text-align: left;
        font-weight: 700;
    }

    .prose tr:nth-child(even) td {
        background: rgba(255, 255, 255, 0.02);
    }

    .prose img,
    .prose video,
    .prose figure {
        margin: 2rem 0;
        border-radius: 1rem;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 0 10px 35px rgba(0, 0, 0, 0.35);
    }

    .prose figcaption {
        margin-top: 0.75rem;
        font-size: 0.9rem;
        color: #9ca3af;
        text-align: center;
    }

    .prose hr {
        border-color: rgba(255, 255, 255, 0.1);
        margin: 3rem 0;
    }
</style>
